{% extends "layouts/base.html" %}
{% load render_table from django_tables2 %}
{% load static i18n %}

{% block title %} Dashboard {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
{% endblock stylesheets %}

{% block content %}

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title"><i class="tim-icons icon-bell-55 text-primary"></i> Таблица лидов</h3>
                <button class="btn btn-primary btn-round" type="button" data-toggle="modal" data-target="#addLeadModal"
                        id="addLeadModalButton">Добавить лида
                </button>
            </div>
            <div class="card-body">
                <div id="main-table" class="table-responsive">
                    <table class="datatable table">
                        <thead>
                        <th>{% trans "id" %}</th>
                        <th>{% trans "status" %}</th>
                        <th>{% trans "name" %}</th>
                        <th>{% trans "phone" %}</th>
                        <th>{% trans "country" %}</th>
                        <th>{% trans "email" %}</th>
                        <th>{% trans "created_date" %}</th>
                        <th>{% trans "manager" %}</th>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


{% endblock content %}

<!-- Modals -->

{% block add_lead_modal %}
<div class="modal fade" id="addLeadModal" tabindex="-1" role="dialog" aria-labelledby="addLeadModal" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Добавление лида</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" id="add-lead-form" action="{% url 'lead:add-lead' %}">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group col-md-6" id="name">
                            {{ form.name.label_tag }}
                            {{ form.name }}
                        </div>
                        <div class="form-group col-md-6" id="phone">
                            {{ form.phone.label_tag }}
                            {{ form.phone }}
                        </div>
                    </div>
                    <div class="form-group" id="email">
                        {{ form.email.label_tag }}
                        {{ form.email }}
                    </div>
                    <div class="form-group" id="created_date">
                        {{ form.created_date.label_tag }}
                        {{ form.created_date }}
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    <button id="add_order" type="submit" class="btn btn-primary">Добавить лид</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
	<script src="{% static 'assets/js/reconnecting-websocket.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/js/websocket.js' %}"></script>
<script>
        $(document).ready(function($) {
    $("tr").click(function() {
        thisdata = $(this).attr('data-href');
        console.log(thisdata);

        window.location.href = thisdata;
    });
});




</script>

<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.12/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.12/js/jquery.dataTables.js"></script>
<script src="{% static 'assets/js/datatables.js' %}"></script>
<script type="text/javascript">
        var ADMIN_LIST_JSON_URL = '{% url "lead:admin_lead_list_json" %}';
        // translations for datatables

        var dt_language = {
            "emptyTable":     "{% trans "No data available in table" %}",
            "info":           "{% trans "Showing _START_ to _END_ of _TOTAL_ entries" %}",
            "infoEmpty":      "{% trans "Showing 0 to 0 of 0 entries" %}",
            "infoFiltered":   "{% trans "(filtered from _MAX_ total entries)" %}",
            "infoPostFix":    "",
            "thousands":      ",",
            "lengthMenu":     "{% trans "Show _MENU_ entries" %}",
            "loadingRecords": "{% trans "Loading..." %}",
            "processing":     "{% trans "Processing..." %}",
            "search":         "{% trans "Search:" %}",
            "zeroRecords":    "{% trans "No matching records found" %}",
            "paginate": {
                "first":      "{% trans "First" %}",
                "last":       "{% trans "Last" %}",
                "next":       "{% trans "Next" %}",
                "previous":   "{% trans "Previous" %}"
            },
            "aria": {
                "sortAscending":  "{% trans ": activate to sort column ascending" %}",
                "sortDescending": "{% trans ": activate to sort column descending" %}"
            }
        }

</script>
{% endblock javascripts %}
